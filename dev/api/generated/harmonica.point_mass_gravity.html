


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
    
        <title>harmonica.point_mass_gravity &mdash; Harmonica</title>
    


  
  
    <link rel="shortcut icon" href="../../_static/favicon.png"/>
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/gallery.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/style.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="harmonica.tesseroid_gravity" href="harmonica.tesseroid_gravity.html" />
    <link rel="prev" title="harmonica.bouguer_correction" href="harmonica.bouguer_correction.html" />
    <!-- Google Analytics tracking code -->
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new
            Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
                })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-38125837-1', 'auto', {'storage': 'none'});
      ga('set', 'anonymizeIp', true);
      ga('send', 'pageview');
    </script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html">
          

          
            
            <img src="../../_static/harmonica-logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                dev
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
    
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../install.html">Installing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gallery/index.html">Gallery</a></li>
</ul>
<p class="caption"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../sample_data/index.html">Sample Data</a></li>
</ul>
<p class="caption"><span class="caption-text">Reference documentation</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">API Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../index.html#gravity-corrections">Gravity Corrections</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html#forward-modelling">Forward modelling</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">harmonica.point_mass_gravity</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#examples-using-harmonica-point-mass-gravity">Examples using <code class="docutils literal notranslate"><span class="pre">harmonica.point_mass_gravity</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="harmonica.tesseroid_gravity.html">harmonica.tesseroid_gravity</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#isostasy">Isostasy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#reference-ellipsoids">Reference Ellipsoids</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#coordinates-conversions">Coordinates Conversions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#input-and-output">Input and Output</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#datasets">Datasets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#utilities">Utilities</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../references.html">References</a></li>
</ul>

            
          

    
        <p class="caption">
            <span class="caption-text">
            
                Getting help and contributing
            
            </span>
        </p>
        <ul>
            
                <li class="toctree-l1"><a href="https://www.fatiando.org"><i class="fa fa-external-link-square fa-fw"></i> Fatiando a Terra</a></li>
            
                <li class="toctree-l1"><a href="https://github.com/fatiando/harmonica/blob/master/CONTRIBUTING.md"><i class="fa fa-users fa-fw"></i> Contributing</a></li>
            
                <li class="toctree-l1"><a href="https://github.com/fatiando/harmonica/blob/master/CODE_OF_CONDUCT.md"><i class="fa fa-gavel fa-fw"></i> Code of Conduct</a></li>
            
                <li class="toctree-l1"><a href="https://gitter.im/fatiando/fatiando"><i class="fa fa-comment fa-fw"></i> Contact</a></li>
            
                <li class="toctree-l1"><a href="https://github.com/fatiando/harmonica"><i class="fa fa-github fa-fw"></i> Source Code</a></li>
            
        </ul>
    

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Harmonica</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          
















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">API Reference</a> &raquo;</li>
        
      <li>harmonica.point_mass_gravity</li>
    
    
    <li class="source-link">
        
            
                
                
                <a href="https://github.com/fatiando/harmonica/issues/new?title=Suggested%20improvement%20for%20api/generated/harmonica.point_mass_gravity&body=Please%20describe%20what%20could%20be%20improved%20about%20this%20page%20or%20the%20typo/mistake%20that%20you%20found%3A"
                   class="fa fa-github"> Improve this page</a>
            
        
        
    </li>

  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="harmonica-point-mass-gravity">
<h1>harmonica.point_mass_gravity<a class="headerlink" href="#harmonica-point-mass-gravity" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="harmonica.point_mass_gravity">
<code class="descclassname">harmonica.</code><code class="descname">point_mass_gravity</code><span class="sig-paren">(</span><em>coordinates</em>, <em>points</em>, <em>masses</em>, <em>field</em>, <em>coordinate_system='cartesian'</em>, <em>dtype='float64'</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/harmonica/forward/point_mass.html#point_mass_gravity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#harmonica.point_mass_gravity" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute gravitational fields of point masses.</p>
<p>It can compute the gravitational fields of point masses on a set of computation
points defined either in Cartesian or geocentric spherical coordinates.</p>
<p>The potential gravity field generated by a point mass with mass <span class="math notranslate nohighlight">\(m\)</span> located at
a point <span class="math notranslate nohighlight">\(Q\)</span> on a computation point <span class="math notranslate nohighlight">\(P\)</span> can be computed as:</p>
<div class="math notranslate nohighlight">
\[V(P) = \frac{G m}{l},\]</div>
<p>where <span class="math notranslate nohighlight">\(G\)</span> is the gravitational constant and <span class="math notranslate nohighlight">\(l\)</span> is the Euclidean
distance between <span class="math notranslate nohighlight">\(P\)</span> and <span class="math notranslate nohighlight">\(Q\)</span> <a class="reference internal" href="../../references.html#blakely1995" id="id1">[Blakely1995]</a>.</p>
<p>In Cartesian coordinates, the points <span class="math notranslate nohighlight">\(P\)</span> and <span class="math notranslate nohighlight">\(Q\)</span> are given by <span class="math notranslate nohighlight">\(x\)</span>,
<span class="math notranslate nohighlight">\(y\)</span> and <span class="math notranslate nohighlight">\(z\)</span> coordinates, which can be translated into <code class="docutils literal notranslate"><span class="pre">northing</span></code>,
<code class="docutils literal notranslate"><span class="pre">easting</span></code> and <code class="docutils literal notranslate"><span class="pre">upward</span></code>, respectively.
If <span class="math notranslate nohighlight">\(P\)</span> is located at <span class="math notranslate nohighlight">\((x, y, z)\)</span>, and <span class="math notranslate nohighlight">\(Q\)</span> at <span class="math notranslate nohighlight">\((x_p, y_p,
z_p)\)</span>, the distance <span class="math notranslate nohighlight">\(l\)</span> can be computed as:</p>
<div class="math notranslate nohighlight">
\[l = \sqrt{ (x - x_p)^2 + (y - y_p)^2 + (z - z_p)^2 }.\]</div>
<p>The gradient of the potential, also known as the gravity acceleration vector
<span class="math notranslate nohighlight">\(\vec{g}\)</span>, is defined as:</p>
<div class="math notranslate nohighlight">
\[\vec{g} = \nabla V.\]</div>
<p>Therefore, the <span class="math notranslate nohighlight">\(z\)</span> component of <span class="math notranslate nohighlight">\(\vec{g}\)</span> at the point <span class="math notranslate nohighlight">\(P\)</span> can be
computed as (remember that <span class="math notranslate nohighlight">\(z\)</span> points upwards):</p>
<div class="math notranslate nohighlight">
\[g_{up}(P) = - \frac{G m}{l^3} (z - z_p).\]</div>
<p>We define the downward component of the gravity acceleration as the opposite of
<span class="math notranslate nohighlight">\(g_{up}\)</span>:</p>
<div class="math notranslate nohighlight">
\[g_{z}(P) = \frac{G m}{l^3} (z - z_p).\]</div>
<p>On a geocentric spherical coordinate system, the points <span class="math notranslate nohighlight">\(P\)</span> and <span class="math notranslate nohighlight">\(Q\)</span> are
given by the <code class="docutils literal notranslate"><span class="pre">longitude</span></code>, <code class="docutils literal notranslate"><span class="pre">latitude</span></code> and <code class="docutils literal notranslate"><span class="pre">radius</span></code> coordinates, i.e.
<span class="math notranslate nohighlight">\(\lambda\)</span>, <span class="math notranslate nohighlight">\(\varphi\)</span> and <span class="math notranslate nohighlight">\(r\)</span>, respectively. On this coordinate
system, the Euclidean distance between <span class="math notranslate nohighlight">\(P(r, \varphi, \lambda)\)</span> and
<span class="math notranslate nohighlight">\(Q(r_p, \varphi_p, \lambda_p)\)</span> can be calculated  as follows <a class="reference internal" href="../../references.html#grombein2013" id="id2">[Grombein2013]</a>:</p>
<div class="math notranslate nohighlight">
\[l = \sqrt{ r^2 + r_p^2 - 2 r r_p \cos \Psi },\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[\cos \Psi = \sin \varphi \sin \varphi_p +
\cos \varphi \cos \varphi_p \cos(\lambda - \lambda_p).\]</div>
<p>The radial component of the acceleration vector on a local North-oriented
system whose origin is located on the point <span class="math notranslate nohighlight">\(P(r, \varphi, \lambda)\)</span>
is given by <a class="reference internal" href="../../references.html#grombein2013" id="id3">[Grombein2013]</a>:</p>
<div class="math notranslate nohighlight">
\[g_r(P) =  - \frac{G m}{l^3} (r - r_p \cos \Psi).\]</div>
<p>We define the downward component of the gravity acceleration <span class="math notranslate nohighlight">\(g_z\)</span> as the
opposite of the radial component:</p>
<div class="math notranslate nohighlight">
\[g_z(P) = \frac{G m}{l^3} (r - r_p \cos \Psi).\]</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">When working in Cartesian coordinates, the <strong>z direction points upwards</strong>, i.e.
positive and negative values of <code class="docutils literal notranslate"><span class="pre">upward</span></code> represent points above and below the
surface, respectively. But remember that the <code class="docutils literal notranslate"><span class="pre">g_z</span></code> field returns the downward
component of the gravity acceleration.</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">When working in geocentric spherical coordinates, remember that the <code class="docutils literal notranslate"><span class="pre">g_z</span></code>
field returns the downward component of the gravity acceleration on the local
North oriented coordinate system. It is equivalent to the opposite of the radial
component, therefore it’s positive if the acceleration vector points inside the
spheroid.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>coordinates</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list or array</span></dt>
<dd><p class="first last">List or array containing the coordinates of computation points in the following
order: <code class="docutils literal notranslate"><span class="pre">easting</span></code>, <code class="docutils literal notranslate"><span class="pre">northing</span></code> and <code class="docutils literal notranslate"><span class="pre">upward</span></code> (if coordinates given in
Cartesian coordiantes), or <code class="docutils literal notranslate"><span class="pre">longitude</span></code>, <code class="docutils literal notranslate"><span class="pre">latitude</span></code> and <code class="docutils literal notranslate"><span class="pre">radius</span></code> (if given
on a spherical geocentric coordinate system).
All <code class="docutils literal notranslate"><span class="pre">easting</span></code>, <code class="docutils literal notranslate"><span class="pre">northing</span></code> and <code class="docutils literal notranslate"><span class="pre">upward</span></code> should be in meters.
Both <code class="docutils literal notranslate"><span class="pre">longitude</span></code> and <code class="docutils literal notranslate"><span class="pre">latitude</span></code> should be in degrees and <code class="docutils literal notranslate"><span class="pre">radius</span></code> in
meters.</p>
</dd>
<dt><strong>points</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list or array</span></dt>
<dd><p class="first last">List or array containing the coordinates of the point masses in the following
order: <code class="docutils literal notranslate"><span class="pre">easting</span></code>, <code class="docutils literal notranslate"><span class="pre">northing</span></code> and <code class="docutils literal notranslate"><span class="pre">upward</span></code> (if coordinates given in
Cartesian coordiantes), or <code class="docutils literal notranslate"><span class="pre">longitude</span></code>, <code class="docutils literal notranslate"><span class="pre">latitude</span></code> and <code class="docutils literal notranslate"><span class="pre">radius</span></code> (if given
on a spherical geocentric coordinate system).
All <code class="docutils literal notranslate"><span class="pre">easting</span></code>, <code class="docutils literal notranslate"><span class="pre">northing</span></code> and <code class="docutils literal notranslate"><span class="pre">upward</span></code> should be in meters.
Both <code class="docutils literal notranslate"><span class="pre">longitude</span></code> and <code class="docutils literal notranslate"><span class="pre">latitude</span></code> should be in degrees and <code class="docutils literal notranslate"><span class="pre">radius</span></code> in
meters.</p>
</dd>
<dt><strong>masses</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list or array</span></dt>
<dd><p class="first last">List or array containing the mass of each point mass in kg.</p>
</dd>
<dt><strong>field</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd><p class="first">Gravitational field that wants to be computed.
The available fields coordinates are:</p>
<ul class="last simple">
<li>Gravitational potential: <code class="docutils literal notranslate"><span class="pre">potential</span></code></li>
<li>Downward acceleration: <code class="docutils literal notranslate"><span class="pre">g_z</span></code></li>
</ul>
</dd>
<dt><strong>coordinate_system</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str (optional)</span></dt>
<dd><p class="first last">Coordinate system of the coordinates of the computation points and the point
masses. Available coordinates systems: <code class="docutils literal notranslate"><span class="pre">cartesian</span></code>, <code class="docutils literal notranslate"><span class="pre">spherical</span></code>.
Default <code class="docutils literal notranslate"><span class="pre">cartesian</span></code>.</p>
</dd>
<dt><strong>dtype</strong> <span class="classifier-delimiter">:</span> <span class="classifier">data-type (optional)</span></dt>
<dd><p class="first last">Data type assigned to resulting gravitational field, and coordinates of point
masses and computation points. Default to <code class="docutils literal notranslate"><span class="pre">np.float64</span></code>.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>result</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array</span></dt>
<dd><p class="first last">Gravitational field generated by the <code class="docutils literal notranslate"><span class="pre">point_mass</span></code> on the computation points
defined in <code class="docutils literal notranslate"><span class="pre">coordinates</span></code>.
The potential is given in SI units, the accelerations in mGal and the Marussi
tensor components in Eotvos.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<div class="section" id="examples-using-harmonica-point-mass-gravity">
<h2>Examples using <code class="docutils literal notranslate"><span class="pre">harmonica.point_mass_gravity</span></code><a class="headerlink" href="#examples-using-harmonica-point-mass-gravity" title="Permalink to this headline">¶</a></h2>
<div class="sphx-glr-thumbcontainer" tooltip="The simplest geometry used to compute gravitational fields are point masses. Although modelling..."><div class="figure" id="id4">
<img alt="../../_images/sphx_glr_point_mass_thumb.png" src="../../_images/sphx_glr_point_mass_thumb.png" />
<p class="caption"><span class="caption-text"><a class="reference internal" href="../../gallery/forward/point_mass.html#sphx-glr-gallery-forward-point-mass-py"><span class="std std-ref">Point Mass in Cartesian Coordinates</span></a></span></p>
</div>
</div><div style='clear:both'></div></div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="harmonica.tesseroid_gravity.html" class="btn btn-neutral float-right" title="harmonica.tesseroid_gravity" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="harmonica.bouguer_correction.html" class="btn btn-neutral float-left" title="harmonica.bouguer_correction" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018-2019, The Harmonica Developers
      <span class="lastupdated">
        Last updated on Aug 15, 2019.
      </span>

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>