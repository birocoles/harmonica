.. note::
    :class: sphx-glr-download-link-note

    Click :ref:`here <sphx_glr_download_sample_data_rio_magnetic.py>` to download the full example code
.. rst-class:: sphx-glr-example-title

.. _sphx_glr_sample_data_rio_magnetic.py:


Total Field Magnetic Anomaly from Rio de Janeiro
================================================

A subsection from an airborne survey of the state of Rio de Janeiro, Brazil, conducted
in 1978. The data are stored in a :class:`pandas.DataFrame` with columns: longitude,
latitude, total field anomaly (nanoTesla), observation height above the WGS84 ellipsoid
(meters), type of flight line (LINE or TIE), and flight line number. See the
documentation for :func:`harmonica.datasets.fetch_rio_magnetic` for more information.



.. image:: /sample_data/images/sphx_glr_rio_magnetic_001.png
    :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

           longitude   latitude  ...  line_type  line_number
    0     -43.197281 -22.050690  ...       LINE         1680
    1     -43.197281 -22.051575  ...       LINE         1680
    2     -43.197266 -22.052460  ...       LINE         1680
    3     -43.197266 -22.053329  ...       LINE         1680
    4     -43.197266 -22.054199  ...       LINE         1680
    ...          ...        ...  ...        ...          ...
    81791 -42.023544 -22.073761  ...        TIE         9600
    81792 -42.024536 -22.073776  ...        TIE         9600
    81793 -42.025513 -22.073776  ...        TIE         9600
    81794 -42.026505 -22.073776  ...        TIE         9600
    81795 -42.027496 -22.073776  ...        TIE         9600

    [81796 rows x 6 columns]
    /home/travis/build/fatiando/harmonica/data/examples/rio_magnetic.py:46: UserWarning: Tight layout not applied. The left and right margins cannot be made large enough to accommodate all axes decorations. 
      plt.tight_layout()





|


.. code-block:: default

    import matplotlib.pyplot as plt
    import cartopy.crs as ccrs
    import verde as vd
    import harmonica as hm

    # Fetch the data in a pandas.DataFrame
    data = hm.datasets.fetch_rio_magnetic()
    print(data)

    # Plot the observations in a Mercator map using Cartopy
    fig = plt.figure(figsize=(10, 6))
    ax = plt.axes(projection=ccrs.Mercator())
    ax.set_title("Magnetic data from Rio de Janeiro", pad=25)
    maxabs = vd.maxabs(data.total_field_anomaly_nt)
    tmp = ax.scatter(
        data.longitude,
        data.latitude,
        c=data.total_field_anomaly_nt,
        s=0.8,
        cmap="seismic",
        vmin=-maxabs,
        vmax=maxabs,
        transform=ccrs.PlateCarree(),
    )
    plt.colorbar(
        tmp,
        ax=ax,
        label="total field magnetic anomaly [nT]",
        orientation="horizontal",
        aspect=50,
        shrink=0.7,
        pad=0.06,
    )
    ax.set_extent(vd.get_region((data.longitude, data.latitude)))
    ax.gridlines(draw_labels=True)
    plt.tight_layout()
    plt.show()


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  1.690 seconds)


.. _sphx_glr_download_sample_data_rio_magnetic.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download

     :download:`Download Python source code: rio_magnetic.py <rio_magnetic.py>`



  .. container:: sphx-glr-download

     :download:`Download Jupyter notebook: rio_magnetic.ipynb <rio_magnetic.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
